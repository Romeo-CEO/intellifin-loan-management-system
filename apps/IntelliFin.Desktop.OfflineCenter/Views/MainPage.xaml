<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="IntelliFin.Desktop.OfflineCenter.Views.MainPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:IntelliFin.Desktop.OfflineCenter.ViewModels"
             Title="{Binding Title}"
             x:DataType="vm:MainViewModel">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" BackgroundColor="{StaticResource Primary}" Padding="20,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <Label Grid.Column="0" 
                       Text="IntelliFin CEO Command Center" 
                       FontSize="24" 
                       FontAttributes="Bold" 
                       TextColor="White" 
                       VerticalOptions="Center" />

                <StackLayout Grid.Column="1" Orientation="Horizontal" VerticalOptions="Center" Margin="0,0,20,0">
                    <Label Text="●" 
                           TextColor="{Binding IsOnline, Converter={StaticResource BoolToColorConverter}}" 
                           FontSize="16" 
                           VerticalOptions="Center" />
                    <Label Text="{Binding ConnectionStatus}" 
                           TextColor="White" 
                           FontSize="14" 
                           Margin="5,0,0,0" 
                           VerticalOptions="Center" />
                </StackLayout>

                <Button Grid.Column="2" 
                        Text="Sync" 
                        Command="{Binding SyncCommand}" 
                        BackgroundColor="{StaticResource Secondary}" 
                        TextColor="White" 
                        CornerRadius="5" 
                        Padding="15,8" />
            </Grid>
        </Border>

        <!-- Main Content -->
        <ScrollView Grid.Row="1" Padding="20">
            <StackLayout Spacing="20">
                
                <!-- Welcome Section -->
                <Frame BackgroundColor="{StaticResource Light}" Padding="20" CornerRadius="10">
                    <StackLayout>
                        <Label Text="Welcome to IntelliFin CEO Command Center" 
                               FontSize="20" 
                               FontAttributes="Bold" 
                               TextColor="{StaticResource TextPrimary}" />
                        <Label Text="Your comprehensive offline-capable financial management dashboard" 
                               FontSize="14" 
                               TextColor="{StaticResource TextSecondary}" 
                               Margin="0,5,0,0" />
                    </StackLayout>
                </Frame>

                <!-- Quick Stats -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Frame Grid.Column="0" BackgroundColor="White" Padding="15" CornerRadius="8" Margin="0,0,5,0">
                        <StackLayout>
                            <Label Text="Portfolio Value" FontSize="12" TextColor="{StaticResource TextSecondary}" />
                            <Label Text="ZMW 2.5M" FontSize="18" FontAttributes="Bold" TextColor="{StaticResource Primary}" />
                        </StackLayout>
                    </Frame>

                    <Frame Grid.Column="1" BackgroundColor="White" Padding="15" CornerRadius="8" Margin="5,0,5,0">
                        <StackLayout>
                            <Label Text="Active Loans" FontSize="12" TextColor="{StaticResource TextSecondary}" />
                            <Label Text="156" FontSize="18" FontAttributes="Bold" TextColor="{StaticResource Success}" />
                        </StackLayout>
                    </Frame>

                    <Frame Grid.Column="2" BackgroundColor="White" Padding="15" CornerRadius="8" Margin="5,0,5,0">
                        <StackLayout>
                            <Label Text="Overdue" FontSize="12" TextColor="{StaticResource TextSecondary}" />
                            <Label Text="12" FontSize="18" FontAttributes="Bold" TextColor="{StaticResource Danger}" />
                        </StackLayout>
                    </Frame>

                    <Frame Grid.Column="3" BackgroundColor="White" Padding="15" CornerRadius="8" Margin="5,0,0,0">
                        <StackLayout>
                            <Label Text="Collections" FontSize="12" TextColor="{StaticResource TextSecondary}" />
                            <Label Text="ZMW 125K" FontSize="18" FontAttributes="Bold" TextColor="{StaticResource Primary}" />
                        </StackLayout>
                    </Frame>
                </Grid>

                <!-- Navigation Cards -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Frame Grid.Row="0" Grid.Column="0" BackgroundColor="White" Padding="20" CornerRadius="10" Margin="0,0,10,10">
                        <StackLayout>
                            <Label Text="📊" FontSize="30" HorizontalOptions="Center" />
                            <Label Text="Dashboard" FontSize="16" FontAttributes="Bold" HorizontalOptions="Center" />
                            <Label Text="View key metrics and insights" FontSize="12" TextColor="{StaticResource TextSecondary}" HorizontalOptions="Center" />
                        </StackLayout>
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding NavigateToDashboardCommand}" />
                        </Frame.GestureRecognizers>
                    </Frame>

                    <Frame Grid.Row="0" Grid.Column="1" BackgroundColor="White" Padding="20" CornerRadius="10" Margin="10,0,0,10">
                        <StackLayout>
                            <Label Text="💰" FontSize="30" HorizontalOptions="Center" />
                            <Label Text="Loan Portfolio" FontSize="16" FontAttributes="Bold" HorizontalOptions="Center" />
                            <Label Text="Manage loans and applications" FontSize="12" TextColor="{StaticResource TextSecondary}" HorizontalOptions="Center" />
                        </StackLayout>
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding NavigateToLoansCommand}" />
                        </Frame.GestureRecognizers>
                    </Frame>

                    <Frame Grid.Row="1" Grid.Column="0" BackgroundColor="White" Padding="20" CornerRadius="10" Margin="0,10,10,0">
                        <StackLayout>
                            <Label Text="📈" FontSize="30" HorizontalOptions="Center" />
                            <Label Text="Financial Overview" FontSize="16" FontAttributes="Bold" HorizontalOptions="Center" />
                            <Label Text="GL, payments, and collections" FontSize="12" TextColor="{StaticResource TextSecondary}" HorizontalOptions="Center" />
                        </StackLayout>
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding NavigateToFinancialCommand}" />
                        </Frame.GestureRecognizers>
                    </Frame>

                    <Frame Grid.Row="1" Grid.Column="1" BackgroundColor="White" Padding="20" CornerRadius="10" Margin="10,10,0,0">
                        <StackLayout>
                            <Label Text="📋" FontSize="30" HorizontalOptions="Center" />
                            <Label Text="Reports" FontSize="16" FontAttributes="Bold" HorizontalOptions="Center" />
                            <Label Text="Generate and view reports" FontSize="12" TextColor="{StaticResource TextSecondary}" HorizontalOptions="Center" />
                        </StackLayout>
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding NavigateToReportsCommand}" />
                        </Frame.GestureRecognizers>
                    </Frame>
                </Grid>

            </StackLayout>
        </ScrollView>

        <!-- Footer -->
        <Border Grid.Row="2" BackgroundColor="{StaticResource Light}" Padding="20,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackLayout Grid.Column="0" Orientation="Horizontal">
                    <Label Text="Last Sync:" FontSize="12" TextColor="{StaticResource TextSecondary}" VerticalOptions="Center" />
                    <Label Text="{Binding LastSyncTime, StringFormat='{0:MMM dd, yyyy HH:mm}'}" 
                           FontSize="12" 
                           TextColor="{StaticResource TextSecondary}" 
                           Margin="5,0,0,0" 
                           VerticalOptions="Center" />
                </StackLayout>

                <StackLayout Grid.Column="1" Orientation="Horizontal" IsVisible="{Binding IsAuthenticated}">
                    <Label Text="{Binding CurrentUser}" FontSize="12" TextColor="{StaticResource TextSecondary}" VerticalOptions="Center" />
                    <Button Text="Logout" 
                            Command="{Binding LogoutCommand}" 
                            FontSize="12" 
                            Padding="10,5" 
                            Margin="10,0,0,0" 
                            BackgroundColor="Transparent" 
                            TextColor="{StaticResource Danger}" />
                </StackLayout>
            </Grid>
        </Border>

    </Grid>

</ContentPage>
